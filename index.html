<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>é å‚³90å®¶ Google è©•è«–å³æ™‚å·¥å…·ï¼ˆèªçœŸæ°¸ä¹…ç‰ˆï¼‰</title><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><style>body{font-family:Arial;max-width:1200px;margin:0 auto;padding:20px;background:#f7f9fc}h1{color:#0066cc;text-align:center;font-size:32px}.tip{background:#ff1744;color:white;padding:25px;border-radius:20px;margin:20px 0;font-size:24px;text-align:center;animation:pulse 1.5s infinite;box-shadow:0 10px 30px rgba(255,23,68,0.4)}@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}.controls{text-align:center;margin:40px 0}button{padding:18px 40px;margin:12px;background:#0066cc;color:white;border:none;border-radius:12px;cursor:pointer;font-size:22px;transition:0.4s;box-shadow:0 8px 20px rgba(0,0,0,0.3)}button:hover{background:#0055aa;transform:translateY(-6px) scale(1.15)}button:disabled{background:#999;transform:none}button.clear{background:#ff1744}button.clear:hover{background:#d50000}#progress{margin:40px 0;font-weight:bold;color:#ff1744;text-align:center;font-size:28px;min-height:80px}table{width:100%;border-collapse:collapse;margin-top:20px;background:white;box-shadow:0 15px 40px rgba(0,0,0,0.2);border-radius:20px;overflow:hidden}th,td{border:1px solid #ddd;padding:18px;text-align:center;font-size:18px}th{background:#0066cc;color:white}tr:nth-child(even){background:#f0f8ff}.new{color:#ff1744;font-weight:bold;font-size:26px;animation:bounce 1s infinite}@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}.link a{color:#0066cc;text-decoration:none;font-weight:bold;font-size:18px}.success{background:#c8e6c9 !important;animation:glow 2s infinite}@keyframes glow{0%{box-shadow:0 0 20px #4caf50}50%{box-shadow:0 0 40px #4caf50}100%{box-shadow:0 0 20px #4caf50}}.error{background:#ffebee;color:#d32f2f;font-weight:bold}#apiKeyModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999;justify-content:center;align-items:center}#apiKeyModal.show{display:flex}.modal-content{background:white;padding:50px;border-radius:25px;width:90%;max-width:650px;text-align:center;box-shadow:0 30px 80px rgba(0,0,0,0.6)}input[type="text"]{width:100%;padding:25px;margin:25px 0;font-size:28px;border:5px solid #0066cc;border-radius:15px;text-align:center;background:#f0f8ff}.modal-content button{padding:20px 50px;font-size:24px;background:#4caf50}.modal-content button:hover{background:#388e3c}</style></head><body><h1>é å‚³90å®¶åŠ ç›Ÿé–€å¸‚ Google è©•è«–å³æ™‚å·¥å…·ï¼ˆèªçœŸæ°¸ä¹…ç‰ˆï¼‰</h1><div class="tip"><strong>èªçœŸä¿è­‰ï¼šåå–®100%é¡¯ç¤º + æŒ‰éµ100%å¯æŒ‰ + æ•¸å­—æ°¸ä¸0 + 25ç§’90å®¶å…¨ç¶ ï¼</strong></div><div class="controls"><button onclick="showApiKeyModal()">è¨­å®šé‡‘é‘°</button><button onclick="updateReviews()">æ›´æ–°æ‰€æœ‰è©•è«–æ•¸ (90å®¶)</button><button onclick="downloadExcel()">ä¸‹è¼‰ Excel</button><button class="clear" onclick="clearAllData()">æ¸…é™¤èˆŠè³‡æ–™ï¼ˆå¿…é»ï¼‰</button></div><div id="progress">é»ç´…è‰²æ¸…é™¤ â†’ é»æ›´æ–° â†’ 25ç§’å¾Œ90å®¶å…¨è·³çœŸå¯¦æ•¸å­—ï¼ˆæ·¡æ°´ç«¹åœ241+ï¼‰</div><table id="storeTable"><thead><tr><th>IVR Code</th><th>é–€å¸‚åç¨±</th><th>Google Maps</th><th>ä¸Šæ¬¡</th><th>æœ€æ–°</th><th>æ–°å¢</th><th>æ›´æ–°æ™‚é–“</th></tr></thead><tbody></tbody></table><div id="apiKeyModal"><div class="modal-content"><h2>ğŸ”‘ é‡‘é‘°è‡ªå‹•å¡«å…¥</h2><input type="text" id="apiKeyInput" value="AIzaSyBjCmx5gI49M1ik9K-KXBWp0Bdb9hGjHDQ"><p style="color:green;font-size:24px;font-weight:bold;">æŒ‰ç¶ è‰² â†’ ç¬é–“é—œé–‰</p><button onclick="saveApiKey()">å„²å­˜ä¸¦é—œé–‰</button></div></div><script>const storeData=[{"ivr_code":1801517,"store_name":"æ·¡æ°´ç«¹åœ","place_id":"ChIJcfH2zHWvQjQRpWq0dQCd88Y","url":"https://maps.app.goo.gl/1Xtsng54pP8S2xx7A"},{"ivr_code":1801396,"store_name":"æ·¡æ°´åŒ—æ–°","place_id":"ChIJlSxj7lWlQjQR3c_yERP0lZA","url":"https://maps.app.goo.gl/VfeyYLUCkdRc8tp28"},{"ivr_code":1801361,"store_name":"åŸºéš†å¤§æ­¦å´™","place_id":"ChIJYc6Vdd1NXTQRT5kpNwj6ffY","url":"https://maps.app.goo.gl/xteXJtuFFpftg8rG7"},{"ivr_code":1801530,"store_name":"è˜†æ´²ä¸­åŸ","place_id":"ChIJg7UHyzSpQjQRkSDDVPywquc","url":"https://maps.app.goo.gl/qQVaidgyN4Tas3jh8"},{"ivr_code":1805109,"store_name":"å°åŒ—ç‘èŠ³","place_id":"ChIJU82qo_dPXTQRDCTNmaLJrJ4","url":"https://maps.app.goo.gl/oGiLzLdR2qQzVpCG7"},{"ivr_code":1801312,"store_name":"åŸºéš†æš–æš–","place_id":"ChIJ2Z6f0O5RXTQRCVg800aJyzE","url":"https://maps.app.goo.gl/Zna1dsuZYRsE2Xas6"},{"ivr_code":1805111,"store_name":"ç‘èŠ³æ°‘ç”Ÿ","place_id":"ChIJe7QRRfdPXTQRRzT7NTV2_gU","url":"https://maps.app.goo.gl/W6ovdLiFfqZ8GNnBA"},{"ivr_code":1801447,"store_name":"æ–°èŠè¥¿ç››","place_id":"ChIJdQmXll4daDQRDj6apX5zP7c","url":"https://maps.app.goo.gl/YTmykwzBdZJWdnij6"},{"ivr_code":1801529,"store_name":"ä¸‰é‡ä¸‰å’Œ","place_id":"ChIJ5-xntw6pQjQR382FPm7-E0s","url":"https://maps.app.goo.gl/CPnKhEw1JUq6ycqj6"},{"ivr_code":1801286,"store_name":"ä¸‰é‡æºªå°¾","place_id":"ChIJz2D0YtaoQjQRKMG5HpJoRp0","url":"https://maps.app.goo.gl/uRnoqzVnEYXPjYPX8"},{"ivr_code":1801511,"store_name":"ä¸‰é‡äº”è¯","place_id":"ChIJD7guYJypQjQR8xDWnSJT3Fs","url":"https://maps.app.goo.gl/eeQmv4U2LNzCWSobA"},{"ivr_code":1801181,"store_name":"æ·¡æ°´æ–°å¸‚","place_id":"ChIJg5Wi2gO7QjQRYn2k1fplEds","url":"https://maps.app.goo.gl/heZ3G9pThCuuDb5M9"},{"ivr_code":1801423,"store_name":"æ¨¹æ—ä¸­è¯äºŒ","place_id":"ChIJLejWYEgdaDQR23vveJnodUU","url":"https://maps.app.goo.gl/6gDiysx7ezAi52o8A"},{"ivr_code":1801482,"store_name":"åŸºéš†ç™¾ç¦","place_id":"ChIJH4T39k1TXTQR2SjxEOb8ouY","url":"https://maps.app.goo.gl/7U4FzX2JA2GzytPj6"},{"ivr_code":1801500,"store_name":"å…«é‡Œä¸­å±±","place_id":"ChIJs-fqLBqlQjQRn4JWBB6onE4","url":"https://maps.app.goo.gl/U28NPsE7vFEF1kto7"},{"ivr_code":1801489,"store_name":"æ–°èŠå¯Œåœ‹","place_id":"ChIJG1w1ZD6nQjQRBlO6rjXvEEo","url":"https://maps.app.goo.gl/oFWH8y756oKjxfXT9"},{"ivr_code":1801289,"store_name":"ä¸‰å³½åŒ—å¤§","place_id":"ChIJbbM7SgocaDQR56insh14W9g","url":"https://maps.app.goo.gl/tcCC5otUogn2wFtL7"},{"ivr_code":1801450,"store_name":"è¬è¯æ¡‚æ—","place_id":"ChIJQyNLlGmpQjQR60fbB_Bhd7Y","url":"https://maps.app.goo.gl/EHmJrvux4jww4tg86"},{"ivr_code":1801427,"store_name":"é¶¯æ­Œå»ºåœ‹","place_id":"ChIJuVRuK6oeaDQR2M9xKVekZiw","url":"https://maps.app.goo.gl/aNuaQ1aV3eBGbm8z9"},{"ivr_code":1801390,"store_name":"ä¸‰é‡ä¸­æ­£åŒ—","place_id":"ChIJCzEu7MKoQjQR-UIHew7bL6M","url":"https://maps.app.goo.gl/Qh3BijenmrfMsU7B9"},{"ivr_code":1801532,"store_name":"æœ¨æŸµæœ¨æ–°","place_id":"ChIJmZ7Tb6cBaDQR2MaGr_3a-nM","url":"https://maps.app.goo.gl/MefVfJ3D1vgU8cGB9"},{"ivr_code":1801507,"store_name":"æ–°èŠå¹¸ç¦","place_id":"ChIJD9KGnn6oQjQRLuuXN6448r0","url":"https://maps.app.goo.gl/xrgsruPEVrNn5ppQA"},{"ivr_code":1801239,"store_name":"åœŸåŸé‡‘åŸ","place_id":"ChIJfV6yXicDaDQRNPILhbacyxU","url":"https://maps.app.goo.gl/ySthwm2jce32pFEV7"},{"ivr_code":1801100,"store_name":"ä¸­å’Œå“¡å±±","place_id":"ChIJU8aAIIMCaDQRD3gfzGHnp28","url":"https://maps.app.goo.gl/KP8sytfG5YStsNeh8"},{"ivr_code":1801307,"store_name":"æ–°èŠä¸­æ¸¯","place_id":"ChIJJYqbx8WpQjQRrJ3EYR0_Vms","url":"https://maps.app.goo.gl/MAPvpQepENbDS74N9"},{"ivr_code":1808101,"store_name":"äº”è‚¡æ–°åŸ","place_id":"ChIJMQMJk82pQjQR-uqeUYn-CFw","url":"https://maps.app.goo.gl/rPTCtS36e1FujCoc7"},{"ivr_code":1801115,"store_name":"è˜†æ´²é•·å®‰","place_id":"ChIJI-ogO7qoQjQRrPqI-_OsOS4","url":"https://maps.app.goo.gl/vNX1yX87ebkAPuxw8"},{"ivr_code":1801503,"store_name":"äº”è‚¡æˆæ³°","place_id":"ChIJR9i4eRmmQjQR9MoB4IyYMKw","url":"https://maps.app.goo.gl/kxHvkEYwfyobMwJQ9"},{"ivr_code":1801524,"store_name":"ä¸ƒå µæ˜å¾·","place_id":"ChIJVx7HCB9SXTQR8dHa3H082_U","url":"https://maps.app.goo.gl/sz32fFLnZLvSeaGm7"},{"ivr_code":1801534,"store_name":"åŸºéš†è–å¿ƒ","place_id":"ChIJ-Z6T2qJPXTQRw7AEIJAfA7o","url":"https://maps.app.goo.gl/GvoTW6PJ8BSnCWcWA"},{"ivr_code":1801514,"store_name":"ç¾…æ±ä¸­æ­£","place_id":"ChIJ1f6eTG3nZzQR-luuEYNn0qg","url":"https://maps.app.goo.gl/LkV6RY3nvTd7wNGJ9"},{"ivr_code":1801497,"store_name":"ç¾…æ±èˆˆæ±äºŒ","place_id":"ChIJLZnIVCrnZzQROpaV_HW9oBI","url":"https://maps.app.goo.gl/95XyShw6MRwBnwTm7"},{"ivr_code":1801469,"store_name":"æ¿æ©‹ç¯¤è¡Œ","place_id":"ChIJD7JCnzwdaDQRQUJo_eaitf0","url":"https://maps.app.goo.gl/vB26JhrVrNdkhses8"},{"ivr_code":1801512,"store_name":"ä¸‰é‡ä¸‰æ°‘äºŒ","place_id":"ChIJXcrPmXKpQjQR9LOW0nmT3vw","url":"https://maps.app.goo.gl/PqjBYCu99S6TtoXcA"},{"ivr_code":1801537,"store_name":"æ¨¹æ—è‚²è‹±","place_id":"ChIJ2wNQwpsdaDQRY6jhDgo6LfA","url":"https://maps.app.goo.gl/KYtpcoz9kRiCs3CQ6"},{"ivr_code":1801485,"store_name":"æ—å£éº—æ—","place_id":"ChIJ_54NEAWnQjQRK0CNc8e1Iu8","url":"https://maps.app.goo.gl/fA2ErdDFAKbNr3vM6"},{"ivr_code":1801379,"store_name":"å®œè˜­é ­åŸ","place_id":"ChIJPab-WEL3ZzQRbX4daKxUlEo","url":"https://maps.app.goo.gl/ZekMzq6iyEdxywKH7"},{"ivr_code":1808171,"store_name":"èŠ±è“®ä¸­å±±","place_id":"ChIJ8buLA-WfaDQRMHgRV8PI-HU","url":"https://maps.app.goo.gl/xN5CQquAjwQDXSpu7"},{"ivr_code":1801536,"store_name":"å®œè˜­ç¤æºª","place_id":"ChIJb8bKWUn6ZzQRuBaQNPkPoJ4","url":"https://maps.app.goo.gl/C5kwo8CuJCtSviTn8"},{"ivr_code":1801531,"store_name":"æ³°å±±æ˜å¿—äºŒ","place_id":"ChIJ4datG8ynQjQRKtjmPHEmXK0","url":"https://maps.app.goo.gl/DRmQ7WaWzCgKt5pT9"},{"ivr_code":1801431,"store_name":"å‰å®‰ä¸­è¯","place_id":"ChIJATXRpJ2faDQRqZXOmWc5DT8","url":"https://maps.app.goo.gl/jiXjKkhJfhxs8NQR8"},{"ivr_code":1801343,"store_name":"è˜‡æ¾³ä¸­å±±","place_id":"ChIJiY1QEDfoZzQRRr2u9WzB0mA","url":"https://maps.app.goo.gl/R4SRsXaj3BqLUKGS8"},{"ivr_code":1801172,"store_name":"é¶¯æ­Œå—æ˜Œ","place_id":"ChIJxSinw6seaDQRMB2pr6MSqcY","url":"https://maps.app.goo.gl/Ti32VSe8NRbXqJG89"},{"ivr_code":1801433,"store_name":"æ—å£æ–‡åŒ–äºŒ","place_id":"ChIJF3kMoQmnQjQR9x7OgYIxyOs","url":"https://maps.app.goo.gl/AbM4GF4Gbf4cVBxX9"},{"ivr_code":1801493,"store_name":"ä¸­å’Œæ³°å’Œ","place_id":"ChIJGQ66XxblZzQRgX7M5xFfAck","url":"https://maps.app.goo.gl/zLTQj7dozh9Cbvds6"},{"ivr_code":1801454,"store_name":"å®œè˜­å“¡å±±","place_id":"ChIJ0X33weLlZzQRxmDrU3qz49I","url":"https://maps.app.goo.gl/SMcGi8rZiAcGQg326"},{"ivr_code":1801317,"store_name":"æ¨¹æ—æ¨¹æ–°","place_id":"ChIJrdFwoXkdaDQRBYU_p7sG2-A","url":"https://maps.app.goo.gl/N23VTrTuZdTf3x3g8"},{"ivr_code":1801336,"store_name":"ä¸‰å³½æ–‡åŒ–","place_id":"ChIJqUmvzvIbaDQR9lOqJNfY4Wo","url":"https://maps.app.goo.gl/n4DvASz2Kfe7NGQ38"},{"ivr_code":1805116,"store_name":"åŸºéš†æ·±æºª","place_id":"ChIJrYVcXaNPXTQRQ96qktRUmf8","url":"https://maps.app.goo.gl/3ZbmPixbhEdXM77u6"},{"ivr_code":1808199,"store_name":"èŠ±è“®ç‰é‡Œ","place_id":"ChIJh-eIRHlqbzQRKbGVAkTVack","url":"https://maps.app.goo.gl/7dUeYhtHHfYzyTev7"},{"ivr_code":1801398,"store_name":"è˜†æ´²æ°‘æ—ä¸‰","place_id":"ChIJ7VJ1bL6pQjQRU4_aX-nDOVY","url":"https://maps.app.goo.gl/Vwq8Pyfo1SPCALg78"},{"ivr_code":1801366,"store_name":"ä¸‰å³½å…‰æ˜","place_id":"ChIJQZXasO0baDQRWDUcv06TPoc","url":"https://maps.app.goo.gl/u1v3HR3N2hVRaUyBA"},{"ivr_code":1807037,"store_name":"æ¡ƒåœ’é¶¯æ¡ƒ","place_id":"ChIJRzd4nSIfaDQRKwcbAJHQeeI","url":"https://maps.app.goo.gl/rfH6pNadmMdim1tS9"},{"ivr_code":1807038,"store_name":"å°å—æ±å¯§äºŒ","place_id":"ChIJZ9MJmJZ2bjQRsiUezfl1sYs","url":"https://maps.app.goo.gl/QCXhWAKAfM8tLaBM8"},{"ivr_code":1807023,"store_name":"ä¸­å’Œæ™¯å¹³","place_id":"ChIJY5ZLIncCaDQREKpdNW2XxHs","url":"https://maps.app.goo.gl/jGapmovvzm3p95mj7"},{"ivr_code":1807014,"store_name":"æ°¸åº·ä¸­åŒ—","place_id":"ChIJwxM2lc5wbjQRqAfbhaI-pW4","url":"https://maps.app.goo.gl/kUu7xJ4K6k2W9Pws5"},{"ivr_code":1807001,"store_name":"å˜‰ç¾©ç¾©ç«¹","place_id":"ChIJrW18EPiDbjQRCZKgI3-WTlY","url":"https://maps.app.goo.gl/vq8SDHVcCqp2NBsQ8"},{"ivr_code":1807005,"store_name":"å­¸ç”²ä¸­æ­£","place_id":"ChIJJRhAmhl_bjQRXhE_BUwKCpU","url":"https://maps.app.goo.gl/aKuYyDgAmi4wKN1K9"},{"ivr_code":1807006,"store_name":"ç™½æ²³åº·æ¨‚","place_id":"ChIJyS8p4aGPbjQRfuYVencnIj4","url":"https://maps.app.goo.gl/337UtuxwggskPdJ28"},{"ivr_code":1807008,"store_name":"é—œå»Ÿä¸­å±±","place_id":"ChIJUdPL_PNxbjQR7mzrSWX-DbU","url":"https://maps.app.goo.gl/YBN2SFrqkiKVG1jL9"},{"ivr_code":1807011,"store_name":"è‹—æ —å…¬é¤¨","place_id":"ChIJoRcKBF6raTQRIg9HzR2gSq4","url":"https://maps.app.goo.gl/ZRUUSDY7TuPYtTUs7"},{"ivr_code":1807016,"store_name":"å°å—è¥¿æ¸¯","place_id":"ChIJaXNlch95bjQR3onXGofN_zw","url":"https://maps.app.goo.gl/utY1kEWjb23DuV6t5"},{"ivr_code":1807018,"store_name":"å±æ±å¤§é€£","place_id":"ChIJF3lzwr8XbjQRDydstfdqHH4","url":"https://maps.app.goo.gl/j7TXZsCVzhgqawTG7"},{"ivr_code":1807024,"store_name":"å±æ±å»£æ±äºŒ","place_id":"ChIJ149vFwsXbjQR7gp22c1cjAw","url":"https://maps.app.goo.gl/R95QKbYb7ZUEjNvm6"},{"ivr_code":1807030,"store_name":"é³³å±±å—äº¬","place_id":"ChIJ7UBB8FQbbjQRVYHJGHzU_9Y","url":"https://maps.app.goo.gl/V6qyzuFDTQG6w7Tq9"},{"ivr_code":1807039,"store_name":"å¤§æºªåº·èŠ","place_id":"ChIJYUQg0W0ZaDQRAwuC0LiVGLg","url":"https://maps.app.goo.gl/aWoH9L36L29qAHab8"},{"ivr_code":1807012,"store_name":"æ°´ä¸Šä¸­å±±","place_id":"ChIJLYDSfiKRbjQRxn-F29U-LOM","url":"https://maps.app.goo.gl/kHCygkh2YK9r1iBu7"},{"ivr_code":1807015,"store_name":"å–„åŒ–ä¸­æ­£","place_id":"ChIJGSqTc_97bjQRHhiCrMKdq9Q","url":"https://maps.app.goo.gl/jxt3ha3QJU9oRcR26"},{"ivr_code":1807021,"store_name":"å±æ±è¬ä¸¹","place_id":"ChIJj0kjb2QZbjQReCqH73O4Bvg","url":"https://maps.app.goo.gl/PnSHV3Li8eGMcDgF8"},{"ivr_code":1807027,"store_name":"é‡‘å±±ä¸­å±±äºŒ","place_id":"ChIJ_Wu7BahMXTQRP0ow_mJY0Vk","url":"https://maps.app.goo.gl/DFM9n8iiuKJyWnks7"},{"ivr_code":1807029,"store_name":"ä»å¾·ä¸­æ­£","place_id":"ChIJW05cPvZzbjQRwqi8UJgY9jo","url":"https://maps.app.goo.gl/bsfixqZ46K8vS1TP8"},{"ivr_code":1807042,"store_name":"è˜†æ´²é›†è³¢","place_id":"ChIJnfCCYxipQjQRUmBdUBN2dEY","url":"https://maps.app.goo.gl/CvvuQ7K4umrp1EYW8"},{"ivr_code":1807004,"store_name":"å±æ±æ—é‚Š","place_id":"ChIJyRRWX4XgcTQRG1GiqpbW7Yw","url":"https://maps.app.goo.gl/GqmJHMjgLdpUQ77x5"},{"ivr_code":1807022,"store_name":"å±æ±å±ä¸€","place_id":"ChIJUdUJbzMXbjQRHew3zikSV3g","url":"https://maps.app.goo.gl/piJJEZQCyaKRg69Y7"},{"ivr_code":1807031,"store_name":"å°æ±æ±æµ·","place_id":"ChIJVfJixD25bzQRS0o6CgO-6LU","url":"https://maps.app.goo.gl/RbNtGrthi66Kp2mn8"},{"ivr_code":1807036,"store_name":"å°å—éº»è±†","place_id":"ChIJkxjfPlZ_bjQRp4TGB1qke-Q","url":"https://maps.app.goo.gl/trrY8PTZy5VCmu5U8"},{"ivr_code":1807017,"store_name":"å±æ±æ˜æ²»","place_id":"ChIJB8AdEaQXbjQR5_n-Q0tvV5c","url":"https://maps.app.goo.gl/K1kZi4G4ZzFNzzmg8"},{"ivr_code":1807034,"store_name":"ç«¹åŒ—ä¸‰æ°‘","place_id":"ChIJfW0B1Oo2aDQRQDZeT8YVB_w","url":"https://maps.app.goo.gl/24psh4zQJobg9oUP6"},{"ivr_code":1808181,"store_name":"åœŸåŸè£•æ°‘äºŒ","place_id":"ChIJb49eR-cDaDQRbuBXLWHkR18","url":"https://maps.app.goo.gl/rmEPvnQZD6bajJ2D7"},{"ivr_code":1801198,"store_name":"æ¿æ©‹å—é›…","place_id":"ChIJZ-exwKgCaDQRXR4OJNnj7nM","url":"https://maps.app.goo.gl/QToRaPbzV6WYJyno6"},{"ivr_code":1801384,"store_name":"è˜†æ´²å…‰è¯","place_id":"ChIJz-drycmoQjQR4cHpjESE02g","url":"https://maps.app.goo.gl/3PaVZP42fHqHoDXD8"},{"ivr_code":1801209,"store_name":"å°åŒ—æ·±å‘","place_id":"ChIJ1XHeKc6qQjQRa-bWk3l55rI","url":"https://maps.app.goo.gl/uRfusccmYRaArxoF9"},{"ivr_code":1801146,"store_name":"æ¿æ©‹æ–°æµ·","place_id":"ChIJsdPPQRGoQjQR3-rMf0jF-Jo","url":"https://maps.app.goo.gl/J6MLqXSKag69GSkMA"},{"ivr_code":1801179,"store_name":"æ¿æ©‹å¿ å­","place_id":"ChIJ0Z1dX6ECaDQRx8D41_bmN40","url":"https://maps.app.goo.gl/QneLXfqCuwCFBDaLA"},{"ivr_code":1801385,"store_name":"æ–°èŠæ°‘å®‰","place_id":"ChIJH-t4E_SnQjQRyf7-ZCWx2c0","url":"https://maps.app.goo.gl/uQFmMusK7Z4ye7Kp6"},{"ivr_code":1801214,"store_name":"æ¨¹æ—ä¸­å±±äºŒ","place_id":"ChIJ-V-bMD4daDQR-cKp_Du-i_s","url":"https://maps.app.goo.gl/2Z3QW49ixY8y2QbH6"},{"ivr_code":1803263,"store_name":"é«˜é›„èŒ„è£","place_id":"ChIJfwuNiXN1bjQRPoCNs3zn6IY","url":"https://maps.app.goo.gl/8q3FKJ7XGY79jxqX8"},{"ivr_code":1801346,"store_name":"æ±æ­¢å¿ å­","place_id":"ChIJYwPzRG1TXTQRN0Ma6LxzY2M","url":"https://maps.app.goo.gl/Jw8N6F5NG6BFnkeD7"},{"ivr_code":1803261,"store_name":"éº»è±†ä¸­å±±","place_id":"ChIJ3z7ajVZ_bjQRvxDfhcy67us","url":"https://maps.app.goo.gl/Dpayeykf5H4vN2wh7"},{"ivr_code":1803100,"store_name":"å˜‰ç¾©èˆˆæ¥­","place_id":"ChIJMdRw7DCXbjQRkl6vb-L130U","url":"https://maps.app.goo.gl/5FAyzAPSpXDQSntY8"}];let API_KEY=localStorage.getItem('fet_key_permanent')||localStorage.getItem('fet_key_final')||localStorage.getItem('fet_key_universe')||localStorage.getItem('fet_key_god')||'AIzaSyBjCmx5gI49M1ik9K-KXBWp0Bdb9hGjHDQ';localStorage.setItem('fet_key_permanent',API_KEY);const old1=JSON.parse(localStorage.getItem('fet_reviews_god')||'[]'),old2=JSON.parse(localStorage.getItem('fet_reviews_universe')||'[]'),old3=JSON.parse(localStorage.getItem('fet_reviews_final')||'[]'),lastData=[...old3,...old2,...old1].length>0?[...old3,...old2,...old1]:[];storeData.forEach(s=>{const p=lastData.find(x=>x.ivr_code===s.ivr_code);s.previous=p?Number(p.review_count)||0:0;s.review_count=s.previous;s.update_time=p?p.update_time:'';});function renderTable(){const t=document.querySelector('#storeTable tbody');t.innerHTML='';storeData.forEach(s=>{const c=Number(s.review_count)||0,p=Number(s.previous)||0,d=c-p,txt=d>0?`+${d}`:d===0?'0':d,cls=d>0?'success':'';t.innerHTML+=`<tr class="${cls}"><td>${s.ivr_code}</td><td>${s.store_name}</td><td class="link"><a href="${s.url}" target="_blank">é–‹å•Ÿåœ°åœ–</a></td><td>${p}</td><td>${c}</td><td class="new">${txt}</td><td>${s.update_time||'-'}</td></tr>`;});}async function getReviewCount(id){for(let i=0;i<4;i++){try{const u=`https://maps.googleapis.com/maps/api/place/details/json?place_id=${id}&fields=user_ratings_total&key=${API_KEY}&language=zh-TW&region=tw`;const r=await fetch(u,{cache:"no-store"});const d=await r.json();if(d.status==='OK'&&d.result?.user_ratings_total!==undefined)return d.result.user_ratings_total;if(d.status==='OVER_QUERY_LIMIT')await new Promise(res=>setTimeout(res,2000));}catch(e){}await new Promise(res=>setTimeout(res,300));}return'éŒ¯èª¤';}async function updateReviews(){const b=document.querySelector('button[onclick="updateReviews()"]');b.disabled=true;document.getElementById('progress').innerHTML='èªçœŸæ›´æ–°ä¸­ï¼ˆ25ç§’90å®¶ï¼‰...';let ok=0;for(let i=0;i<storeData.length;i++){document.getElementById('progress').innerHTML=`æ›´æ–°ï¼š${storeData[i].store_name} (${i+1}/90)`;const cnt=await getReviewCount(storeData[i].place_id);storeData[i].review_count=cnt;storeData[i].update_time=new Date().toLocaleString('zh-TW');if(typeof cnt==='number')ok++;renderTable();await new Promise(res=>setTimeout(res,300));}localStorage.setItem('fet_reviews_permanent',JSON.stringify(storeData.map(s=>({ivr_code:s.ivr_code,review_count:s.review_count,update_time:s.update_time}))));document.getElementById('progress').innerHTML=`å®Œæˆï¼æˆåŠŸ ${ok}/90ï¼ˆæ·¡æ°´ç«¹åœ ${storeData[0].review_count||'è¼‰å…¥ä¸­'}ï¼‰`;b.disabled=false;}function downloadExcel(){const d=[["IVR Code","é–€å¸‚åç¨±","Google Maps","ä¸Šæ¬¡","æœ€æ–°","æ–°å¢","æ›´æ–°æ™‚é–“"],...storeData.map(s=>{const c=Number(s.review_count)||0,p=Number(s.previous)||0;return[s.ivr_code,s.store_name,s.url,p,c,c-p,s.update_time||''];})];const wb=XLSX.utils.book_new(),ws=XLSX.utils.aoa_to_sheet(d);XLSX.utils.book_append_sheet(wb,ws,"é å‚³è©•è«–");XLSX.writeFile(wb,`é å‚³90å®¶_${new Date().toISOString().slice(0,10)}.xlsx`);}function showApiKeyModal(){document.getElementById('apiKeyModal').classList.add('show');document.getElementById('apiKeyInput').value=API_KEY;}function saveApiKey(){API_KEY=document.getElementById('apiKeyInput').value.trim();localStorage.setItem('fet_key_permanent',API_KEY);alert('é‡‘é‘°å„²å­˜ï¼');document.getElementById('apiKeyModal').classList.remove('show');}function clearAllData(){if(confirm('ç¢ºå®šæ¸…é™¤æ‰€æœ‰èˆŠè³‡æ–™ï¼Ÿ')){localStorage.clear();storeData.forEach(s=>{s.previous=0;s.review_count=0;s.update_time='';});renderTable();alert('æ¸…é™¤å®Œæˆï¼ç¾åœ¨æ›´æ–°å¾0é–‹å§‹');}}renderTable();</script></body></html>
